[toc]
该文章记录数字的计算原理
## 概览

JS中所有的数值都是以64位小数存储的，存储规则遵循IEEE 754
某些运算只有整数才能完成，此时 JavaScript 会自动把64位浮点数，转成32位整数，然后再进行运算。
小数点前的数字多于21位或小数点后的零多于5个自动将其转化为科学技术法表示。

## 问题
- [ ] 数值是怎样存储的?（参考：JavaScript 浮点数陷阱及解法）
- [ ] 如何避免精度问题？
- [ ] 大数危机及如何避免
## 待阅读


## 问题解答

#### 为什么0.1+0.2=0.300000000004？
计算机中是以二进制保存数的，JS中使用64位表示数值，JS遵循IEEE 754规范。

原因：
- 使用二进制表达十进制的小数时，某些数字无法被有限位的二进制小数表示
- 单精度和双精度的浮点数只包括 7 位或者 15 位的有效小数位，存储需要无限位表示的小数时只能存储近似值

##### 1、十进制数转换成二进制数
```
1(10) = 2^0 = 1(2)

2(10) = 2^1 = 10(2)

3(10) = 2^1 + 2^0 = 11(2)

0.5(10) = 2^-1 = 0.1(2)

0.25(10) = 2^-2 = 0.01(2)

0.75(10) = 2^-1 + 2^-2 = 0.11(2)
```

##### 2、计算机如何表示二进制数
```
// float32: 1位符号, 8位指数(256个数字表示[-127, 128]), 23位小数
// float64: 1位符号, 11位指数(2048个数字表示[-1023, 1024]), 52位小数

1(10)
0 0(127) 0(10进制表示计算规则)
0 01111111 00000000000000000000000(32float)
0 01111111111 0000000000000000000000000000000000000000000000000000(64float)

2(10)
0 1(128) 0(10进制表示计算规则)
0 10000000 00000000000000000000000(32float)
0 10000000000 0000000000000000000000000000000000000000000000000000(64float)

0.5(10)
0 -1(126) 0(10进制表示计算规则)
0 01111110 00000000000000000000000(32float)
0 01111111110 0000000000000000000000000000000000000000000000000000(64float)

0.25(10)
0 -2(125) 0(10进制表示计算规则)
0 01111101 00000000000000000000000(32float)
0 01111111101 0000000000000000000000000000000000000000000000000000(64float)

0.75(10)
0 -1(126) 1(10进制表示计算规则：1.5 * 2 ** -1)
0 01111110 10000000000000000000000(32float)
0 01111111110 1000000000000000000000000000000000000000000000000000(64float)
```

##### 3、计算机如何计算二进制数
<https://draveness.me/whys-the-design-decimal-and-rational/>
<https://blog.csdn.net/tercel_zhang/article/details/52537726>


参考：
- [为什么 0.1 + 0.2 = 0.300000004](https://draveness.me/whys-the-design-floating-point-arithmetic)
- [工具展示二进制码位](http://www.binaryconvert.com/result_double.html?decimal=049)


#### 数值是怎样存储的?
[工具](http://www.binaryconvert.com/convert_double.html)


#### 能表示的整数范围
指数部分一共11个二进制位，